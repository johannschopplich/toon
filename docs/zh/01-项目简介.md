# TOON 项目简介

## 什么是 TOON？

TOON（Token-Oriented Object Notation，面向 Token 的对象表示法）是一种专为大语言模型（LLM）设计的紧凑型、人类可读的数据格式。它的主要目标是在保持可读性的同时，显著减少向 LLM 传递结构化数据时的 token 消耗。

## 为什么需要 TOON？

在 AI 应用中，尽管模型变得越来越便宜和易用，但 **LLM 的 token 仍然需要花钱**。传统的 JSON 格式虽然广泛使用，但存在冗余和 token 浪费的问题。

看一个对比例子：

**传统 JSON 格式：**
```json
{
  "users": [
    { "id": 1, "name": "Alice", "role": "admin" },
    { "id": 2, "name": "Bob", "role": "user" }
  ]
}
```

**TOON 格式：**
```
users[2]{id,name,role}:
  1,Alice,admin
  2,Bob,user
```

同样的信息，TOON 使用了更少的 token。

## 核心特点

### 1. Token 高效性
- **节省 30-60% 的 token**：相比 JSON 通常节省 30-60% 的 token 使用量
- **性能数据**：在实际测试中，对比 JSON 节省了 49.1% 的 token，对比 XML 节省了 56.0%

### 2. LLM 友好的设计
- **显式长度标记**：使用 `[N]` 明确标注数组长度，帮助模型验证输出
- **字段列表声明**：使用 `{field1,field2}` 预先声明字段，减少歧义
- **自文档化**：格式本身就说明了数据结构

### 3. 最小化语法
- **去除冗余标点**：不需要大括号、中括号和大部分引号
- **减少重复**：对于统一结构的对象数组，键名只声明一次

### 4. 基于缩进的结构
- **类似 YAML**：使用空格缩进替代大括号，提高可读性
- **清晰的层次**：通过缩进一目了然地看出数据层级

### 5. 表格化数组
- **CSV 风格的表格**：对于结构统一的对象数组，采用类似 CSV 的表格格式
- **声明一次，多次使用**：字段名在头部声明，后续每行只包含值

## 适用场景

TOON 最适合的场景是**结构统一的复杂对象**：

- **多字段记录**：每条记录包含多个字段
- **统一结构**：所有记录具有相同的字段集合
- **批量数据**：需要传递大量结构化数据给 LLM

### 典型应用

- 向 LLM 传递员工信息、订单数据、分析报表等结构化数据
- 降低大规模 API 调用的 token 成本
- 提高 LLM 对结构化数据的理解准确度

## 性能数据

### Token 效率测试

在真实数据集上的测试结果：

| 数据集 | TOON Tokens | vs JSON 节省 | vs XML 节省 |
|--------|-------------|--------------|-------------|
| GitHub 仓库（100条） | 8,745 | 42.3% | 48.8% |
| 日分析数据（180天） | 4,507 | 58.9% | 65.7% |
| 电商订单 | 166 | 35.4% | 38.7% |
| **总计** | **13,418** | **49.1%** | **56.0%** |

### 检索准确度测试

在 4 个 LLM 模型上进行 154 个数据检索问题的测试：

**关键结论**：TOON 达到了 **69.2% 的准确率**（vs JSON 的 65.4%），同时只使用了 **46.3% 的 token**。

## 设计理念

TOON 不是要替代 JSON，而是为特定场景（LLM 输入）提供更优的选择：

- **专注于输入**：TOON 主要用于向 LLM 传递数据，而非让 LLM 生成输出
- **人类可读**：保持格式的可读性和可维护性
- **确定性输出**：相同的输入总是产生相同的输出
- **简单解析**：虽然有自己的语法，但规则简单明确

## 项目组成

这是一个 TypeScript 项目，包含：

- **核心编码器**：将 JavaScript 对象转换为 TOON 格式
- **完整测试套件**：使用 Vitest 进行测试
- **性能基准测试**：独立的 benchmark 包，包含 token 效率和检索准确度测试
- **详细规范**：正式的 v1 格式规范文档
- **多语言移植**：社区已移植到 Elixir、PHP、Python、Ruby、Java、.NET、Swift、Go 等多种语言

## 技术栈

- **开发语言**：TypeScript 5.9.3
- **构建工具**：tsdown
- **测试框架**：Vitest
- **包管理**：pnpm（monorepo 结构）
- **代码质量**：ESLint + TypeScript strict 模式

## 下一步

- 查看 [使用方法](./02-使用方法.md) 了解如何在项目中使用 TOON
- 查看 [实现原理](./03-实现原理.md) 深入理解 TOON 的内部机制
- 查看 [额外思考](./04-额外思考.md) 了解对这个项目的深度分析
